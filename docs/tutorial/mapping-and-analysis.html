<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorial/mapping-and-analysis" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Mapping and Analysis | Kobe Tran | Elastic Stack Notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://devkobetran.github.io/elasticstack-notes/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://devkobetran.github.io/elasticstack-notes/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://devkobetran.github.io/elasticstack-notes/docs/tutorial/mapping-and-analysis"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Mapping and Analysis | Kobe Tran | Elastic Stack Notes"><meta data-rh="true" name="description" content="Intro to Analysis"><meta data-rh="true" property="og:description" content="Intro to Analysis"><link data-rh="true" rel="icon" href="/elasticstack-notes/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://devkobetran.github.io/elasticstack-notes/docs/tutorial/mapping-and-analysis"><link data-rh="true" rel="alternate" href="https://devkobetran.github.io/elasticstack-notes/docs/tutorial/mapping-and-analysis" hreflang="en"><link data-rh="true" rel="alternate" href="https://devkobetran.github.io/elasticstack-notes/docs/tutorial/mapping-and-analysis" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/elasticstack-notes/blog/rss.xml" title="Kobe Tran | Elastic Stack Notes RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/elasticstack-notes/blog/atom.xml" title="Kobe Tran | Elastic Stack Notes Atom Feed"><link rel="stylesheet" href="/elasticstack-notes/assets/css/styles.993a030a.css">
<script src="/elasticstack-notes/assets/js/runtime~main.eaa45155.js" defer="defer"></script>
<script src="/elasticstack-notes/assets/js/main.7902cbc2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/elasticstack-notes/"><div class="navbar__logo"><img src="/elasticstack-notes/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/elasticstack-notes/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kobe Tran Elastic Stack Notes</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/elasticstack-notes/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/elasticstack-notes/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/devkobetran/elasticstack-notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/elasticstack-notes/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/elasticstack-notes/docs/environment-setup">Environment Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/elasticstack-notes/docs/reference-docs">Reference Docs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/elasticstack-notes/docs/category/tutorial">Tutorial</a><button aria-label="Collapse sidebar category &#x27;Tutorial&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/elasticstack-notes/docs/tutorial/managing-documents">Managing Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/elasticstack-notes/docs/tutorial/mapping-and-analysis">Mapping and Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/elasticstack-notes/docs/tutorial/searching-for-data">Searching for Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/elasticstack-notes/docs/tutorial/joining-queries">Joining Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/elasticstack-notes/docs/tutorial/controlling-query-results">Controlling Query Results</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/elasticstack-notes/docs/tutorial/aggregations">Aggregations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/elasticstack-notes/docs/tutorial/improving-search-results">Improving Search Results</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/elasticstack-notes/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/elasticstack-notes/docs/category/tutorial"><span itemprop="name">Tutorial</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Mapping and Analysis</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Mapping and Analysis</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="intro-to-analysis">Intro to Analysis<a href="#intro-to-analysis" class="hash-link" aria-label="Direct link to Intro to Analysis" title="Direct link to Intro to Analysis">​</a></h2>
<ul>
<li>Aka <strong>text analysis</strong>
<ul>
<li>Applies to text fields / values</li>
<li>Text values are analyzed when indexing documents</li>
<li>The result is stored in data stuctures that are efficient for searching</li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><ul>
<li>The <code>_source</code> object is not used when searching for documents<!-- -->
<ul>
<li>It contains the exact values specified when indexing a document</li>
</ul>
</li>
</ul></div></div>
<!-- -->
<ul>
<li>An <strong>Analyzer</strong> is made of:<!-- -->
<ol>
<li><strong>Character Filters</strong>: receives the original text and adds, removes, or changes characters.</li>
</ol>
<ul>
<li>Zero or more character filters can be present</li>
<li>Character filters are applied in the order in which they are specified</li>
<li>e.g. remove html tags and only keep the text</li>
</ul>
<ol start="2">
<li><strong>Tokenizer</strong>: tokenizes a string, meaning split the text into tokens</li>
</ol>
<ul>
<li>There can only be one tokenizer</li>
<li>Characters could be removed such as punctuation</li>
<li>e.g. Split a sentence word by word and remove punctuation and white spaces</li>
</ul>
<ol start="3">
<li><strong>Token Filters</strong>: receive the output of the tokenizer as input (the tokens)</li>
</ol>
<ul>
<li>could add, remove, or modify tokens</li>
<li>zero or more token filters can be present</li>
<li>Token filters are applied in the order in which they are specified</li>
<li>e.g. lowercase all the tokens</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-analyze-api">Using the Analyze API<a href="#using-the-analyze-api" class="hash-link" aria-label="Direct link to Using the Analyze API" title="Direct link to Using the Analyze API">​</a></h2>
<ul>
<li>Open up localhost Kibana Console</li>
<li>Compare this query:</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_analyze</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;1 random sentence     in the air, but then the... PUPPIES :0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;analyzer&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>to this query:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_analyze</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;1 random sentence     in the air, but then the... PUPPIES :0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;char_filter&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;tokenizer&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;filter&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;lowercase&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>These two queries have the same output!</p><p>An <code>analyzer</code> is broken up into three parts: <code>char_filter</code>, <code>tokenizer</code>, and <code>filter</code>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-inverted-indices">Understanding inverted indices<a href="#understanding-inverted-indices" class="hash-link" aria-label="Direct link to Understanding inverted indices" title="Direct link to Understanding inverted indices">​</a></h2>
<ul>
<li>A field&#x27;s values are stored in one of several data structures<!-- -->
<ul>
<li>The data structure depends on the field&#x27;s data type</li>
</ul>
</li>
<li>Ensures efficient data access (e.g. searches)</li>
<li>Handled by Apache Lucene, not Elasticsearch</li>
<li><strong>Inverted Indices</strong>: mapping between terms and which documents contain them<!-- -->
<ul>
<li>terms are the tokens emitted by the analyzer</li>
<li>terms are sorted alphabetically for performance reasons</li>
</ul>
</li>
<li>Inverted indices enable fast searches</li>
<li>Inverted indices contain more than just terms and document IDs<!-- -->
<ul>
<li>information for relevance scoring</li>
</ul>
</li>
<li>One inverted index per text field</li>
<li>Other data types like numeric, date, etc use BKD trees</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-mapping">Introduction to mapping<a href="#introduction-to-mapping" class="hash-link" aria-label="Direct link to Introduction to mapping" title="Direct link to Introduction to mapping">​</a></h2>
<ul>
<li><strong>Mapping</strong> defines the structure of documents (fields and their data types)<!-- -->
<ul>
<li>used to configure how values are indexed</li>
</ul>
</li>
<li>Analogy --&gt; a table schema in a relational database</li>
<li><strong>Explicit Mapping</strong> define field mappings ourselves</li>
<li><strong>Dynamic mapping</strong>: elasticsearch generates field mappings for us</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview-of-data-types">Overview of data types<a href="#overview-of-data-types" class="hash-link" aria-label="Direct link to Overview of data types" title="Direct link to Overview of data types">​</a></h2>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html" target="_blank" rel="noopener noreferrer">Field Data Types Documentation</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="object-data-type">Object data type<a href="#object-data-type" class="hash-link" aria-label="Direct link to Object data type" title="Direct link to Object data type">​</a></h3>
<ul>
<li>used for any JSON object</li>
<li>objects may be nested</li>
<li>Mapped using the <code>properties</code> parameter</li>
<li>Objects are not stored as objects in Apache Lucene<!-- -->
<ul>
<li>Objects are transformed to ensure that we can index any valid JSON</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nested-data-type">Nested data type<a href="#nested-data-type" class="hash-link" aria-label="Direct link to Nested data type" title="Direct link to Nested data type">​</a></h3>
<ul>
<li>Similar to the <code>object</code> data type but maintains object relationships<!-- -->
<ul>
<li>Useful when indexing arrays of objects</li>
</ul>
</li>
<li>Enables us to query objects independently<!-- -->
<ul>
<li>Must use the <code>nested</code> query</li>
</ul>
</li>
<li><code>nested</code> objects are stored as hidden documents</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="keyword-data-type">Keyword data type<a href="#keyword-data-type" class="hash-link" aria-label="Direct link to Keyword data type" title="Direct link to Keyword data type">​</a></h3>
<ul>
<li>Used for exact matching of values</li>
<li>Used for filtering, aggregations, and sorting</li>
<li>e.g. searching for articles with a status of <code>PUBLISHED</code></li>
<li>For full-text searches, use the <code>text</code> data type instead<!-- -->
<ul>
<li>e.g. searching the body text of an article</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-the-keyword-data-type-works">How the keyword data type works<a href="#how-the-keyword-data-type-works" class="hash-link" aria-label="Direct link to How the keyword data type works" title="Direct link to How the keyword data type works">​</a></h2>
<ul>
<li><code>keyword</code> fields are analyzed with the <code>keyword</code> analyzer</li>
<li>The <code>keyword</code> analyzer is a no-op analyzer<!-- -->
<ul>
<li>It outputs the unmodified string as a single token</li>
<li>This token is placed into the inverted index</li>
</ul>
</li>
<li><code>keyword</code> fields are used for exact matching, aggregations, and sorting</li>
<li>Example:</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_analyze</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;1 random sentence     in the air, but then the... PUPPIES :0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;analyzer&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The output will contain a single token with the text string completely untouched.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-type-coercion">Understanding type coercion<a href="#understanding-type-coercion" class="hash-link" aria-label="Direct link to Understanding type coercion" title="Direct link to Understanding type coercion">​</a></h2>
<ul>
<li>Data types are inspected when indexing documents<!-- -->
<ul>
<li>They are validated and some valid values are rejected</li>
<li>e.g trying to index an object for a <code>text</code> field</li>
</ul>
</li>
<li>Sometimes, providing the wrong data type is okay</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">coercion_test</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_doc</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;price&quot;</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">7.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">coercion_test</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_doc</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;price&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;7.4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">coercion_test</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_doc</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;price&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;7.4m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>For the second PUT, it passes in a string <code>&quot;7.4&quot;</code> which does not match the type <code>float</code> in the mapping.</p><p>Elasticsearch will actually convert the string if it only contains numbers into the <code>float</code> type.</p><p>For the third PUT, it fails because the string contained a letter <code>m</code> along with <code>7.4</code>, so it could not be converted to <code>float</code> type.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-__source-object">Understanding the <code>__source</code> object<a href="#understanding-the-__source-object" class="hash-link" aria-label="Direct link to understanding-the-__source-object" title="Direct link to understanding-the-__source-object">​</a></h3>
<ul>
<li>Contains the values that were supplied at index time<!-- -->
<ul>
<li>e.g. contains <code>&quot;7.4&quot;</code> and not the values that are indexed (<code>7.4</code>)</li>
</ul>
</li>
<li>Search queries use indexed values, not <code>_source</code>
<ul>
<li>BKD trees, inverted indices, etc</li>
</ul>
</li>
<li><code>_source</code> does not reflect how values are indexed</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><ul>
<li>Keep coercion in mind if you use values from <code>__source</code></li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="more-on-coercion">More on Coercion<a href="#more-on-coercion" class="hash-link" aria-label="Direct link to More on Coercion" title="Direct link to More on Coercion">​</a></h3>
<ul>
<li>Supplying a floating point for an <code>integer</code> field will truncate it to an integer</li>
<li>Coercion is not used for dynamic mapping<!-- -->
<ul>
<li>Supplying &quot;7.4&quot; for a new field will create a text mapping</li>
</ul>
</li>
<li>Always try to use the correct data type<!-- -->
<ul>
<li>Especially the first time you index a field</li>
</ul>
</li>
<li>Coercion is enabled by default<!-- -->
<ul>
<li>Could disable it</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-arrays">Understanding arrays<a href="#understanding-arrays" class="hash-link" aria-label="Direct link to Understanding arrays" title="Direct link to Understanding arrays">​</a></h2>
<ul>
<li>There is no such things as an array data type</li>
<li>Any field may contain zero or more values<!-- -->
<ul>
<li>No configuration or mapping needed</li>
<li>Simply supply an array when indexing a document</li>
</ul>
</li>
<li>Constraints:<!-- -->
<ul>
<li>Array values should be of the same data type</li>
<li>Coercion only works for fields that are already mapped<!-- -->
<ul>
<li>If creating a field mapping with dynamic mapping, an array must contain the same data type.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Array Example</strong>:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_analyze</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Strings are simply&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;merged together.&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;analyzer&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Looking at the output, the multiple strings are treated as a single string and not as multiple values.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nested-arrays">Nested Arrays<a href="#nested-arrays" class="hash-link" aria-label="Direct link to Nested Arrays" title="Direct link to Nested Arrays">​</a></h3>
<ul>
<li>Arrays may contain nested arrays</li>
<li>Arrays are flattened during indexing</li>
<li><code>[1, [2, 3]]</code> becomes <code>[1, 2, 3]</code></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Remember to use the <code>nested</code> data type for arrays of objects if you need to query the objects independently.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-explicit-mappings">Adding explicit mappings<a href="#adding-explicit-mappings" class="hash-link" aria-label="Direct link to Adding explicit mappings" title="Direct link to Adding explicit mappings">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;rating&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;float&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;product_id&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;integer&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;author&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;first_name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;last_name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="retrieving-mappings">Retrieving Mappings<a href="#retrieving-mappings" class="hash-link" aria-label="Direct link to Retrieving Mappings" title="Direct link to Retrieving Mappings">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">GET </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_mapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_mapping</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">field</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">content</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GET </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_mapping</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">field</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">author</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">email</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-dot-notation-in-field-names">Using dot notation in field names<a href="#using-dot-notation-in-field-names" class="hash-link" aria-label="Direct link to Using dot notation in field names" title="Direct link to Using dot notation in field names">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;author&quot;</span><span class="token plain">:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;first_name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;last_name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;email&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>can be converted to dot notation:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">//...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;author.first_name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;author.last_name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;author.email&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-mappings-to-existing-indices">Adding mappings to existing indices<a href="#adding-mappings-to-existing-indices" class="hash-link" aria-label="Direct link to Adding mappings to existing indices" title="Direct link to Adding mappings to existing indices">​</a></h2>
<ul>
<li><strong><code>created_at</code> timestamp custom mapping Example</strong>:</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">reviews</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_mapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;created_at&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;date&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-dates-work-in-elasticsearch">How dates work in Elasticsearch<a href="#how-dates-work-in-elasticsearch" class="hash-link" aria-label="Direct link to How dates work in Elasticsearch" title="Direct link to How dates work in Elasticsearch">​</a></h2>
<ul>
<li>specified in one of 3 ways<!-- -->
<ul>
<li>specially formatted strings</li>
<li>ms since the epoch (<code>long</code>)</li>
<li>seconds since the epoch (<code>integer</code>)</li>
</ul>
</li>
<li>Epoch refers to the 1st of January 1970</li>
<li>Custom formats are supported</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-behavior-of-date-fields">Default behavior of date fields<a href="#default-behavior-of-date-fields" class="hash-link" aria-label="Direct link to Default behavior of date fields" title="Direct link to Default behavior of date fields">​</a></h3>
<ul>
<li>3 formats:<!-- -->
<ul>
<li>A date without time</li>
<li>A date with time</li>
<li>ms since the epoch</li>
</ul>
</li>
<li>UTC timezone assumed if none is specified</li>
<li>Dates must be formatted according to the ISO 8601 spec</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-date-fields-are-stored">How <code>date</code> fields are stored<a href="#how-date-fields-are-stored" class="hash-link" aria-label="Direct link to how-date-fields-are-stored" title="Direct link to how-date-fields-are-stored">​</a></h3>
<ul>
<li>Stored internally as ms since the epoch</li>
<li>Any valid value that you supply at index time is converted to a long value internally</li>
<li>Dates are converted to UTC timezone</li>
<li>The same date conversion happens for search queries, too</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Don&#x27;t provide UNIX timestamps for default date fields</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-missing-fields-are-handled">How missing fields are handled<a href="#how-missing-fields-are-handled" class="hash-link" aria-label="Direct link to How missing fields are handled" title="Direct link to How missing fields are handled">​</a></h2>
<ul>
<li>All fields in Elasticsearch are optional</li>
<li>You can leave out a field when indexing documents</li>
<li>Some integrity checks need to be done at the application level<!-- -->
<ul>
<li>e.g. have required fields</li>
</ul>
</li>
<li>Adding a field mapping does not make a field required</li>
<li>Searches automatically handle missing fields</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview-of-mapping-parameters">Overview of mapping parameters<a href="#overview-of-mapping-parameters" class="hash-link" aria-label="Direct link to Overview of mapping parameters" title="Direct link to Overview of mapping parameters">​</a></h2>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-params.html" target="_blank" rel="noopener noreferrer">Mapping Parameters</a></li>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-date-format.html" target="_blank" rel="noopener noreferrer">format documentation</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="format-parameter"><code>format</code> parameter<a href="#format-parameter" class="hash-link" aria-label="Direct link to format-parameter" title="Direct link to format-parameter">​</a></h3>
<ul>
<li>Used to customize the format for <code>date</code> fields<!-- -->
<ul>
<li>Recommended to use default format: <code>strict_date_optional_time||epoch_millis</code></li>
</ul>
</li>
<li>Using Java&#x27;s <code>DateFormatter</code> syntax:<!-- -->
<ul>
<li>e.g. <code>&quot;dd/MM/yyyy&quot;</code></li>
</ul>
</li>
<li>Using built-in formats<!-- -->
<ul>
<li>e.g. &quot;<code>epoch_second</code>&quot;</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="properties-parameter"><code>properties</code> parameter<a href="#properties-parameter" class="hash-link" aria-label="Direct link to properties-parameter" title="Direct link to properties-parameter">​</a></h3>
<ul>
<li>Define nested fields for <code>object</code> and <code>nested</code> fields</li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;sold_by&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token plain">: { </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="coerce-parameter"><code>coerce</code> parameter<a href="#coerce-parameter" class="hash-link" aria-label="Direct link to coerce-parameter" title="Direct link to coerce-parameter">​</a></h3>
<ul>
<li>Used to enable or diable coercion of values (enabled by default)</li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;amount&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;float&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;coerce&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example of disabling coercion at the index field to not tediously add coercion to every field:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;settings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index.mapping.coerce&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;amount&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;float&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;coerce&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The &quot;amount&quot; field overwrites the index level coerce value of <code>false</code>.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-doc_values">Introduction to <code>doc_values</code><a href="#introduction-to-doc_values" class="hash-link" aria-label="Direct link to introduction-to-doc_values" title="Direct link to introduction-to-doc_values">​</a></h3>
<ul>
<li>Elasticsearch makes use of several data structures<!-- -->
<ul>
<li>No single data structure serves all purposes</li>
</ul>
</li>
<li>Inverted indices are excellent for searching text<!-- -->
<ul>
<li>They don&#x27;t perform well for many other data access patterns</li>
</ul>
</li>
<li>&quot;Doc Values&quot; is another data structure used by Apache Lucene<!-- -->
<ul>
<li>Optimized for a different data access pattern (document --&gt; terms)</li>
</ul>
</li>
<li><code>doc_values</code> are an &quot;uninverted&quot; inverted index.<!-- -->
<ul>
<li>used for sorting, aggregations, and scripting</li>
<li>could be used along side inverted indices</li>
<li>Elasticsearch automatically queries the appropriate data structure</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disabling-doc_values">Disabling <code>doc_values</code><a href="#disabling-doc_values" class="hash-link" aria-label="Direct link to disabling-doc_values" title="Direct link to disabling-doc_values">​</a></h3>
<ul>
<li>Set the <code>doc_values</code> parameter to <code>false</code> to save disk space<!-- -->
<ul>
<li>slightly increases the indexing throughput</li>
</ul>
</li>
<li>Only disable doc values if you won&#x27;t use aggregations, sorting, scripting</li>
<li>Particularly useful for large indices; typically not worth it for small ones</li>
<li>Cannot be changed without reindexing documents into new index.<!-- -->
<ul>
<li>Use with caution and try to anticipate how fields will be queried</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;buyer_email&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;doc_values&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="norms-parameter"><code>norms</code> parameter<a href="#norms-parameter" class="hash-link" aria-label="Direct link to norms-parameter" title="Direct link to norms-parameter">​</a></h3>
<ul>
<li>Normalization factors used for relevance scoring</li>
<li>Norms refers to the storage of various normalization factors that are used to compute relevance scores.</li>
<li>Want to rank results as we filter them</li>
<li>Norms can be disabled to save disk space<!-- -->
<ul>
<li>Disable norms for fields that won&#x27;t be used for relevance scoring</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">products</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;tags&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;norms&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="index-parameter"><code>index</code> parameter<a href="#index-parameter" class="hash-link" aria-label="Direct link to index-parameter" title="Direct link to index-parameter">​</a></h3>
<ul>
<li>Disables indexing for a field</li>
<li>Values are still stored within <code>__source</code></li>
<li>Useful if you won&#x27;t use a field for search queries</li>
<li>Saves disk space and slightly improves indexing throughput</li>
<li>Often used for time series data</li>
<li>Fields with indexing disabled can still be used for aggregations</li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">metrics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;server_id&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;integer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="null_value-parameter"><code>null_value</code> parameter<a href="#null_value-parameter" class="hash-link" aria-label="Direct link to null_value-parameter" title="Direct link to null_value-parameter">​</a></h3>
<ul>
<li><code>NULL</code> values cannot be indexed or searched</li>
<li>Use this parameter to replace <code>NULL</code> values with another value</li>
<li>Only works for explicity <code>NULL</code> values</li>
<li>The replacement value must be of the same data type as the field</li>
<li>Does not affect the value stored within <code>__source</code></li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;partner_id&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;null_value&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;NULL&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="copy_to-parameter"><code>copy_to</code> parameter<a href="#copy_to-parameter" class="hash-link" aria-label="Direct link to copy_to-parameter" title="Direct link to copy_to-parameter">​</a></h3>
<ul>
<li>Used to copy multiple field values into a &quot;group field&quot;</li>
<li>Simply specify the name of the target field as the value</li>
<li>Example: <code>first_name</code> and <code>last_name</code> --&gt; <code>full_name</code></li>
<li>Values are copied, not terms/tokens<!-- -->
<ul>
<li>The analyzer of the target field is used for the values</li>
</ul>
</li>
<li>The target field is not part of <code>__source</code></li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;first_name&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;copy_to&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;full_name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;last_name&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;copy_to&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;full_name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;full_name&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="updating-existing-mappings">Updating existing mappings<a href="#updating-existing-mappings" class="hash-link" aria-label="Direct link to Updating existing mappings" title="Direct link to Updating existing mappings">​</a></h2>
<ul>
<li>Suppose that product IDs may now include letters</li>
<li>We need to change the <code>product_id</code> field&#x27;s data type to either <code>text</code> or <code>keyword</code>
<ul>
<li>We won&#x27;t use the field for full-text searches</li>
<li>We will use it for filtering, so the <code>keyword</code> data type is ideal</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="limitations-for-updating-mappings">Limitations for updating mappings<a href="#limitations-for-updating-mappings" class="hash-link" aria-label="Direct link to Limitations for updating mappings" title="Direct link to Limitations for updating mappings">​</a></h3>
<ul>
<li>Elasticsearch field mappings cannot be changed.</li>
<li>Could add new field mappings</li>
<li>A few mapping parameters could be updated for existing mappings</li>
<li>Being able to update mappings would be problematic for existing documents<!-- -->
<ul>
<li>Text values have already been analyzed, for instance</li>
<li>Changing between some data types would require rebuilding the whole data structure</li>
</ul>
</li>
<li>Even for an empty index, we cannot update a mapping</li>
<li>Field mappings cannot be removed<!-- -->
<ul>
<li>Just leave out the field when indexing documents</li>
</ul>
</li>
<li>The Update By Query API can be used to reclaim disk space</li>
<li>The solution is to reindex documents into a new index</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reindexing-documents-with-the-reindex-api">Reindexing documents with the Reindex API<a href="#reindexing-documents-with-the-reindex-api" class="hash-link" aria-label="Direct link to Reindexing documents with the Reindex API" title="Direct link to Reindexing documents with the Reindex API">​</a></h2>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html" target="_blank" rel="noopener noreferrer">Reindex API</a> moves documents from one index to another so that we don&#x27;t have to</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="__source-data-types"><code>__source</code> data types<a href="#__source-data-types" class="hash-link" aria-label="Direct link to __source-data-types" title="Direct link to __source-data-types">​</a></h3>
<ul>
<li>The data type doesn&#x27;t reflect how the values are indexed</li>
<li><code>__source</code> contains the field values supplied at index time</li>
<li>It&#x27;s common to use <code>__source</code> values from search results<!-- -->
<ul>
<li>expect a string for a <code>keyword</code> field</li>
</ul>
</li>
<li>modify the <code>__source</code> value while reindexing</li>
<li>Can be handled at the application level</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;script&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    if(ctx.__source.product_id != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      ctx._source.product_id = ctx._source.product_id.toString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reindex-documents-matching-a-query">Reindex documents matching a query<a href="#reindex-documents-matching-a-query" class="hash-link" aria-label="Direct link to Reindex documents matching a query" title="Direct link to Reindex documents matching a query">​</a></h3>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;query&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;match_all&quot;</span><span class="token plain">: { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The above code specifies a query within the &quot;source&quot; parameter to only reindex documents that match the query.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reindex-only-positive-reviews">Reindex only positive reviews<a href="#reindex-only-positive-reviews" class="hash-link" aria-label="Direct link to Reindex only positive reviews" title="Direct link to Reindex only positive reviews">​</a></h3>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;query&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;range&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;rating&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;gte&quot;</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">4.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="removing-fields">Removing fields<a href="#removing-fields" class="hash-link" aria-label="Direct link to Removing fields" title="Direct link to Removing fields">​</a></h3>
<ul>
<li>Field mappings cannot be deleted</li>
<li>Fields can be left out when indexing documents</li>
<li>Maybe we want to reclaim disk space used by a field<!-- -->
<ul>
<li>Already indexed values still take up disk space</li>
<li>For large data sets, this may be worthwhile<!-- -->
<ul>
<li>Assuming that we no longer need the values</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;__source&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;created_at&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rating&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><ul>
<li>By specifying an array of field names, only those fields are included for each document when they are indexed into the destination index.</li>
<li>In other words, any fields that you leave out will not be reindexed.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="changing-a-fields-name">Changing a field&#x27;s name<a href="#changing-a-fields-name" class="hash-link" aria-label="Direct link to Changing a field&#x27;s name" title="Direct link to Changing a field&#x27;s name">​</a></h3>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;script&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    # Rename &quot;</span><span class="token plain">content</span><span class="token string" style="color:#e3116c">&quot; field to &quot;</span><span class="token keyword" style="color:#00009f">comment</span><span class="token string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    ctx.__source.comment = ctx.__source.remove(&quot;</span><span class="token plain">content</span><span class="token string" style="color:#e3116c">&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Example: Ignore reviews with ratings below 4.0</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;dest&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;index&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;reviews_new&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;script&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;source&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      if(ctx.__source.rating &lt; 4.0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        ctx.op = &quot;</span><span class="token plain">noop</span><span class="token string" style="color:#e3116c">&quot; # can also be set to &quot;</span><span class="token keyword" style="color:#00009f">delete</span><span class="token string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>For <code>&quot;noop&quot;</code> value, the document will not be indexed into the destination index.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-ctxop-within-scripts">Using <code>ctx.op</code> within scripts<a href="#using-ctxop-within-scripts" class="hash-link" aria-label="Direct link to using-ctxop-within-scripts" title="Direct link to using-ctxop-within-scripts">​</a></h3>
<ul>
<li>Usually, using the <code>query</code> parameter is possible</li>
<li>For more advanced use cases, <code>ctx.op</code> can be used</li>
<li>Using the query parameter is better performance wise and is preferred</li>
<li>Specifying <code>&quot;delete&quot;</code> deletes the document within the destination index<!-- -->
<ul>
<li>The destination index might not be empty as in our example</li>
<li>The same can be done with the Delete by Query API</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-for-the-reindex-api">Parameters for the Reindex API<a href="#parameters-for-the-reindex-api" class="hash-link" aria-label="Direct link to Parameters for the Reindex API" title="Direct link to Parameters for the Reindex API">​</a></h3>
<ul>
<li>A snapshot is created before reindexing documents</li>
<li>A version conflict causes the query to be aborted by default</li>
<li>The destination index is not empty</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="batching--throttling">Batching &amp; Throttling<a href="#batching--throttling" class="hash-link" aria-label="Direct link to Batching &amp; Throttling" title="Direct link to Batching &amp; Throttling">​</a></h3>
<ul>
<li>The Reindex API performs operations in batches<!-- -->
<ul>
<li>Similar to the Update by Query and Delete by Query Applies</li>
<li>It uses the Scroll API internally</li>
<li>This is how millions of documents can be reindexed efficiently</li>
</ul>
</li>
<li>Throttling can be configured to limit the performance impact<!-- -->
<ul>
<li>Useful for production clusters</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="defining-field-aliases">Defining field aliases<a href="#defining-field-aliases" class="hash-link" aria-label="Direct link to Defining field aliases" title="Direct link to Defining field aliases">​</a></h2>
<ul>
<li>Field names can be changed when reindexing documents<!-- -->
<ul>
<li>Not worth it for lots of document</li>
</ul>
</li>
<li>Alternative: use <strong>field aliases</strong>
<ul>
<li>Doesn&#x27;t require documents to be reindexed</li>
<li>Aliases can be used within queries</li>
<li>Aliases are defined with a field mapping</li>
</ul>
</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_reindex</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_mapping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;comment&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;alias&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;path&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;content&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-field-aliases">Updating field aliases<a href="#updating-field-aliases" class="hash-link" aria-label="Direct link to Updating field aliases" title="Direct link to Updating field aliases">​</a></h3>
<ul>
<li>Field Aliases could be updated<!-- -->
<ul>
<li>Only its target field though</li>
</ul>
</li>
<li>Simply perform a mapping update with a new path value</li>
<li>Possible because aliases don&#x27;t affect indexing<!-- -->
<ul>
<li>It&#x27;s a query-level construct</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="index-aliases">Index Aliases<a href="#index-aliases" class="hash-link" aria-label="Direct link to Index Aliases" title="Direct link to Index Aliases">​</a></h3>
<ul>
<li>Elasticsearch also supports Index Aliases</li>
<li>Used when dealing with large data volumes</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="multi-field-mappings">Multi-field mappings<a href="#multi-field-mappings" class="hash-link" aria-label="Direct link to Multi-field mappings" title="Direct link to Multi-field mappings">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">multi_field_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">:{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;description&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;ingredients&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;fields&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;keyword&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="index-templates">Index Templates<a href="#index-templates" class="hash-link" aria-label="Direct link to Index Templates" title="Direct link to Index Templates">​</a></h2>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-put-template.html" target="_blank" rel="noopener noreferrer">Index Templates API</a></li>
<li>A way to automatically apply settings and mappings on index creation<!-- -->
<ul>
<li>Works by matching index names against an <strong>index pattern</strong></li>
</ul>
</li>
<li>Only a single index template can be applied to a new index</li>
<li>Used for data sets that are stored in multiple indices<!-- -->
<ul>
<li>e.g time series data</li>
</ul>
</li>
<li>Enables us to simply index documents into indices that don&#x27;t already existing</li>
<li>Indices can be created manually<!-- -->
<ul>
<li>API request and index templates are merged (the request takes precedence)</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="structure-of-index-templates">Structure of index Templates<a href="#structure-of-index-templates" class="hash-link" aria-label="Direct link to Structure of index Templates" title="Direct link to Structure of index Templates">​</a></h3>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_index_template</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">my</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">index</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">template</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;index_patterns&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;my-index-pattern*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;template&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;settings&quot;</span><span class="token plain">: { </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: { </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><ul>
<li><code>PUT /_index_template/my-index-template</code> is the name of the index template</li>
<li><code>&quot;index_patterns&quot;: [&quot;my-index-pattern*&quot;]</code> is a pattern that determines when the index template is applied</li>
<li><code>&quot;settings&quot;: { ... },</code> is settings to apply to the new index</li>
<li><code>&quot;mappings&quot;: { ... }</code> is field mappings to add to the new index</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="priorities">Priorities<a href="#priorities" class="hash-link" aria-label="Direct link to Priorities" title="Direct link to Priorities">​</a></h3>
<ul>
<li>Index patterns cannot overlap by default</li>
<li>Only a single index template can be applied to a new index</li>
<li>Specify a <code>priority</code> paramter to handle overlapping index patterns<!-- -->
<ul>
<li>Defaults to zero</li>
<li>The index template with the highest priority &quot;wins&quot;</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-dynamic-mapping">Introduction to dynamic mapping<a href="#introduction-to-dynamic-mapping" class="hash-link" aria-label="Direct link to Introduction to dynamic mapping" title="Direct link to Introduction to dynamic mapping">​</a></h2>
<ul>
<li>JSON <code>String</code> --&gt; Elasticsearch (<code>text</code> field with <code>keyword</code> mapping, <code>date</code> field, <code>float</code> field or <code>long</code> field)</li>
<li>JSON <code>Integer</code> --&gt; Elasticsearch <code>long</code></li>
<li>JSON <code>Floating point</code> number --&gt; Elasticsearch <code>float</code></li>
<li>JSON <code>array</code> --&gt; Depends on the first non-null value</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-dynamic-mapping">Configuring dynamic mapping<a href="#configuring-dynamic-mapping" class="hash-link" aria-label="Direct link to Configuring dynamic mapping" title="Direct link to Configuring dynamic mapping">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">people</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;dynamic&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;first_name&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-dynamic-to-false">Setting <code>dynamic</code> to <code>false</code><a href="#setting-dynamic-to-false" class="hash-link" aria-label="Direct link to setting-dynamic-to-false" title="Direct link to setting-dynamic-to-false">​</a></h3>
<ul>
<li>New fields are ignored<!-- -->
<ul>
<li>They are not indexed, but still part of <code>__source</code></li>
</ul>
</li>
<li>No inverted index is created for the <code>last_name</code> field<!-- -->
<ul>
<li>Querying the field gives no results</li>
</ul>
</li>
<li>Fields cannot be indexed without a mapping<!-- -->
<ul>
<li>When enabled, dynamic mapping creates one before indexing values</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-dynamic-to-strict">Setting <code>dynamic</code> to <code>strict</code><a href="#setting-dynamic-to-strict" class="hash-link" aria-label="Direct link to setting-dynamic-to-strict" title="Direct link to setting-dynamic-to-strict">​</a></h3>
<ul>
<li>Elasticsearch will reject unmapped fields<!-- -->
<ul>
<li>All fields must be mapped explicitly</li>
<li>Similar behavior as relational databases</li>
</ul>
</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">people</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;dynamic&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;properties&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;first_name&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="numeric-detection">Numeric Detection<a href="#numeric-detection" class="hash-link" aria-label="Direct link to Numeric Detection" title="Direct link to Numeric Detection">​</a></h3>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">computers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;numeric_detection&quot;</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>When adding a doc, if the field values are string versions of numbers, dynamic mapping will set values to long or float.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-templates">Dynamic Templates<a href="#dynamic-templates" class="hash-link" aria-label="Direct link to Dynamic Templates" title="Direct link to Dynamic Templates">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dynamic_template_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;mappings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;dynamic_templates&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;integer&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;match_mapping_type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;long&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;mapping&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;integer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-and-unmatch-parameters"><code>match</code> and <code>unmatch</code> parameters<a href="#match-and-unmatch-parameters" class="hash-link" aria-label="Direct link to match-and-unmatch-parameters" title="Direct link to match-and-unmatch-parameters">​</a></h3>
<ul>
<li>used to specify conditions for field names</li>
<li>Field names must match the condition specified by the <code>match</code> parameter</li>
<li><code>unmatch</code> is used to exclude fields that were matched by the <code>match</code> parameter</li>
<li>Both parameters support patterns with wildcards(*)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="path_match-and-path_unmatch-parameters"><code>path_match</code> and <code>path_unmatch</code> parameters<a href="#path_match-and-path_unmatch-parameters" class="hash-link" aria-label="Direct link to path_match-and-path_unmatch-parameters" title="Direct link to path_match-and-path_unmatch-parameters"> ​</a></h3>
<ul>
<li>These parameters evaluate the full field path<!-- -->
<ul>
<li>i.e. not just the field names</li>
</ul>
</li>
<li>dot notation<!-- -->
<ul>
<li><code>name.first_name</code></li>
</ul>
</li>
<li>wildcards are supported</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="index-templates-vs-dynamic-templates">Index templates vs dynamic templates<a href="#index-templates-vs-dynamic-templates" class="hash-link" aria-label="Direct link to Index templates vs dynamic templates" title="Direct link to Index templates vs dynamic templates">​</a></h3>
<ul>
<li>Index templates apply mappings and index settings for matching indices<!-- -->
<ul>
<li>This happens when indices are created and their names match a pattern</li>
</ul>
</li>
<li>Dynamic templates are evaluated when new fields are encountered<!-- -->
<ul>
<li>and dynamic mapping is enabled</li>
<li>The specified field mapping is added if the templates conditions match</li>
</ul>
</li>
<li>Index templates define fixed mappings; dynamic templates are dynamic</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mapping-recommendations">Mapping Recommendations<a href="#mapping-recommendations" class="hash-link" aria-label="Direct link to Mapping Recommendations" title="Direct link to Mapping Recommendations">​</a></h2>
<ul>
<li>Dynamic mapping is convenient, but not good for production</li>
<li>Use explicit mappings<!-- -->
<ul>
<li>Save disk space with optimized mappings with storing many documents</li>
<li>set <code>dynamic</code> to <code>strict</code>, not <code>false</code>, to avoid surprises and unexpected results</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mapping-of-text-fields">Mapping of text fields<a href="#mapping-of-text-fields" class="hash-link" aria-label="Direct link to Mapping of text fields" title="Direct link to Mapping of text fields">​</a></h3>
<ul>
<li>Don&#x27;t always map strings as both <code>text</code> and <code>keyword</code>
<ul>
<li>Typically only one is needed</li>
<li>Each mapping requires disk space</li>
</ul>
</li>
<li>Do you need to perform full-text searches?<!-- -->
<ul>
<li>Add a <code>text</code> mapping</li>
</ul>
</li>
<li>Do you need to do aggregations, sorting, or filtering on exact values?<!-- -->
<ul>
<li>Add a <code>keyword</code> mapping</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disable-coercion">Disable Coercion<a href="#disable-coercion" class="hash-link" aria-label="Direct link to Disable Coercion" title="Direct link to Disable Coercion">​</a></h3>
<ul>
<li>Coercion forgives you for doing the wrong thing</li>
<li>Do things correctly instead<!-- -->
<ul>
<li>Always use the correct data types</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-appropriate-numeric-data-types">Use appropriate numeric data types<a href="#use-appropriate-numeric-data-types" class="hash-link" aria-label="Direct link to Use appropriate numeric data types" title="Direct link to Use appropriate numeric data types">​</a></h3>
<ul>
<li>For whole numbers, the <code>integer</code> data type might be enough<!-- -->
<ul>
<li><code>long</code> can store larger numbers, but also uses more disk space</li>
</ul>
</li>
<li>For decimal numbers, the <code>float</code> data type might be precise enough<!-- -->
<ul>
<li><code>double</code> stores numbers with a higher precision but uses 2x disk space</li>
<li>Usually, <code>float</code> provides enough precision</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mapping-parameters">Mapping parameters<a href="#mapping-parameters" class="hash-link" aria-label="Direct link to Mapping parameters" title="Direct link to Mapping parameters">​</a></h3>
<ul>
<li>Set <code>doc_values</code> to <code>false</code> if you don&#x27;t need sorting, aggregations, and scripting</li>
<li>Set <code>norms</code> to <code>false</code> if you don&#x27;t need relevance scoring</li>
<li>Set <code>index</code> to <code>false</code> fi you don&#x27;t need to filter on values<!-- -->
<ul>
<li>You can still do aggregations (e.g. for time series data)</li>
</ul>
</li>
<li>Only worth the effort when storing lots of documents</li>
<li>Worse case scenario, need to reindex documents</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stemming--stop-words">Stemming &amp; Stop words<a href="#stemming--stop-words" class="hash-link" aria-label="Direct link to Stemming &amp; Stop words" title="Direct link to Stemming &amp; Stop words">​</a></h3>
<ul>
<li><strong>Stemming</strong> reduces words to their root format<!-- -->
<ul>
<li>e.g. <code>loved</code> --&gt; <code>love</code></li>
<li>e.g. <code>drinking</code> --&gt; <code>drink</code></li>
</ul>
</li>
<li><strong>Stop Words</strong>: words that are filtered out during text analysis<!-- -->
<ul>
<li>Common words such as &quot;a&quot;, &quot;the&quot;, &quot;at&quot;, &quot;of&quot;, &quot;on&quot;, etc.</li>
</ul>
</li>
<li>They provide little to no value for relevance scoring</li>
<li>Fairly common to remove such words</li>
<li>Not removed by default, and generally not recommended to do so</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="built-in-analyzers">Built-in Analyzers<a href="#built-in-analyzers" class="hash-link" aria-label="Direct link to Built-in Analyzers" title="Direct link to Built-in Analyzers">​</a></h2>
<ul>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-analyzers.html" target="_blank" rel="noopener noreferrer">Built-in Analyzers Docs</a></li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The main example we will be looking at is:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Is that Peter&#x27;s cute-looking dog?&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="standard-analyzer"><code>standard</code> analyzer<a href="#standard-analyzer" class="hash-link" aria-label="Direct link to standard-analyzer" title="Direct link to standard-analyzer">​</a></h3>
<ul>
<li>Splits text at word boundaries and removes punctuation<!-- -->
<ul>
<li>Done by the <code>standard</code> tokenizer</li>
</ul>
</li>
<li>Lowercases letters with the <code>lowercase</code> token filter</li>
<li>Contains the <code>stop</code> token filter (disabled by default)</li>
<li>Example after standard analyzer:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&quot;is&quot;, &quot;that&quot;, &quot;peter&#x27;s&quot;, &quot;cute&quot;, &quot;looking&quot;, &quot;dog&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simple-analyzer"><code>simple</code> analyzer<a href="#simple-analyzer" class="hash-link" aria-label="Direct link to simple-analyzer" title="Direct link to simple-analyzer">​</a></h3>
<ul>
<li>similar to the <code>standard</code> analyzer<!-- -->
<ul>
<li>splits into tokens when encountering anything else than letters</li>
</ul>
</li>
<li>Lowercases letters with the <code>lowercase</code> tokenizer<!-- -->
<ul>
<li>Unusual and a performance hack</li>
</ul>
</li>
<li>Example after simple analyzer:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&quot;is&quot;, &quot;that&quot;, &quot;peter&quot;, &quot;s&quot;, &quot;cute&quot;, &quot;looking&quot;, &quot;dog&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="whitespace-analyzer"><code>whitespace</code> analyzer<a href="#whitespace-analyzer" class="hash-link" aria-label="Direct link to whitespace-analyzer" title="Direct link to whitespace-analyzer">​</a></h3>
<ul>
<li>Splits text into tokens by whitespace</li>
<li>Does not lowercase letters</li>
<li>Example after whitespace analyzer:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&quot;Is&quot;, &quot;that&quot;, &quot;Peter&#x27;s&quot;, &quot;cute-looking&quot;, &quot;dog?&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="keyword-analyzer"><code>keyword</code> analyzer<a href="#keyword-analyzer" class="hash-link" aria-label="Direct link to keyword-analyzer" title="Direct link to keyword-analyzer">​</a></h3>
<ul>
<li>No-op analyzer that leaves the input text intact<!-- -->
<ul>
<li>outputs it as a single token</li>
</ul>
</li>
<li>Used for <code>keyword</code> fields by default<!-- -->
<ul>
<li>Used for exact matching</li>
</ul>
</li>
<li>Example after keyword analyzer:</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&quot;Is that Peter&#x27;s cute-looking dog?&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pattern-analyzer"><code>pattern</code> analyzer<a href="#pattern-analyzer" class="hash-link" aria-label="Direct link to pattern-analyzer" title="Direct link to pattern-analyzer">​</a></h3>
<ul>
<li>A regular expression is used to match token separators<!-- -->
<ul>
<li>It should match whatever should split the text into tokens</li>
</ul>
</li>
<li>This analyzer is very flexible</li>
<li>The default pattern matches all non-word characters (\W+)</li>
<li>Lowercases letters by default</li>
<li>Example after pattern analyzer</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&quot;is&quot;, &quot;that&quot;, &quot;peter&quot;, &quot;s&quot;, &quot;cute&quot;, &quot;looking&quot;, &quot;dog&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="custom-analyzers">Custom Analyzers<a href="#custom-analyzers" class="hash-link" aria-label="Direct link to Custom Analyzers" title="Direct link to Custom Analyzers">​</a></h2>
<ul>
<li>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis.html" target="_blank" rel="noopener noreferrer">Text Analysis Docs</a></p>
</li>
<li>
<p>Example:</p>
</li>
</ul>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">analyzer_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;settings&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;analysis&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;analyzer&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;my_custom_analyzer&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;custom&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;char_filter&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;html_strip&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;tokenizer&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;filter&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;lowercase&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;stop&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;asciifolding&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-analyzers-to-existing-indices">Adding Analyzers to existing indices<a href="#adding-analyzers-to-existing-indices" class="hash-link" aria-label="Direct link to Adding Analyzers to existing indices" title="Direct link to Adding Analyzers to existing indices">​</a></h2>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Any attempt to search or index documents will be refused</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// while the index is in the closed state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">analyzer_test</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_close</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">analyzer_test</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;analysis&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;analyzer&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;my_second_analyzer&quot;</span><span class="token plain">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;type&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;custom&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;char_filter&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;html_strip&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;tokenizer&quot;</span><span class="token plain">: </span><span class="token string" style="color:#e3116c">&quot;standard&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;filter&quot;</span><span class="token plain">: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;lowercase&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;stop&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;asciifolding&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// the index is in the open state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// now able to use the analyzer within field mappings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PUT </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">analyzer_test</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">_open</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="open--closed-indices">Open &amp; Closed Indices<a href="#open--closed-indices" class="hash-link" aria-label="Direct link to Open &amp; Closed Indices" title="Direct link to Open &amp; Closed Indices">​</a></h3>
<ul>
<li>An open index is available for indexing and search requests</li>
<li>A closed index will refuse requests<!-- -->
<ul>
<li>Read and write requests are blocked</li>
<li>Necessary for performing some operations</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-and-static-settings">Dynamic and static settings<a href="#dynamic-and-static-settings" class="hash-link" aria-label="Direct link to Dynamic and static settings" title="Direct link to Dynamic and static settings">​</a></h3>
<ul>
<li>Dynamic settings can be changed without closing the index first<!-- -->
<ul>
<li>Requires no downtime</li>
</ul>
</li>
<li>Static settings require the index to be closed first<!-- -->
<ul>
<li>The index will be briefly unavailable</li>
</ul>
</li>
<li>Analysis settings are static settings</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="opening--closing-indices">Opening &amp; closing indices<a href="#opening--closing-indices" class="hash-link" aria-label="Direct link to Opening &amp; closing indices" title="Direct link to Opening &amp; closing indices">​</a></h3>
<ul>
<li>Fairly quick, but might not be an option for production clusters<!-- -->
<ul>
<li>E.g. mission critical systems where downtime is unacceptable</li>
</ul>
</li>
<li>Alternatively reindex documents into a new index<!-- -->
<ul>
<li>Create the new index with the updated settings</li>
<li>Use an index alias for the transition</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-analyzers">Updating Analyzers<a href="#updating-analyzers" class="hash-link" aria-label="Direct link to Updating Analyzers" title="Direct link to Updating Analyzers">​</a></h3>
<ul>
<li>Analyzers can be updated</li>
<li>Pay attention to existing documents<!-- -->
<ul>
<li>They were analyzed using the old version of the analyzer</li>
<li>Reindex these documents to avoid headaches</li>
</ul>
</li>
<li>Try to get analyzers right before indexing documents<!-- -->
<ul>
<li>Use Update By Query API to reindex values</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/devkobetran/elasticstack-notes/docs/tutorial/mapping-and-analysis.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/elasticstack-notes/docs/tutorial/managing-documents"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Managing Documents</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/elasticstack-notes/docs/tutorial/searching-for-data"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Searching for Data</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intro-to-analysis" class="table-of-contents__link toc-highlight">Intro to Analysis</a></li><li><a href="#using-the-analyze-api" class="table-of-contents__link toc-highlight">Using the Analyze API</a></li><li><a href="#understanding-inverted-indices" class="table-of-contents__link toc-highlight">Understanding inverted indices</a></li><li><a href="#introduction-to-mapping" class="table-of-contents__link toc-highlight">Introduction to mapping</a></li><li><a href="#overview-of-data-types" class="table-of-contents__link toc-highlight">Overview of data types</a><ul><li><a href="#object-data-type" class="table-of-contents__link toc-highlight">Object data type</a></li><li><a href="#nested-data-type" class="table-of-contents__link toc-highlight">Nested data type</a></li><li><a href="#keyword-data-type" class="table-of-contents__link toc-highlight">Keyword data type</a></li></ul></li><li><a href="#how-the-keyword-data-type-works" class="table-of-contents__link toc-highlight">How the keyword data type works</a></li><li><a href="#understanding-type-coercion" class="table-of-contents__link toc-highlight">Understanding type coercion</a><ul><li><a href="#understanding-the-__source-object" class="table-of-contents__link toc-highlight">Understanding the <code>__source</code> object</a></li><li><a href="#more-on-coercion" class="table-of-contents__link toc-highlight">More on Coercion</a></li></ul></li><li><a href="#understanding-arrays" class="table-of-contents__link toc-highlight">Understanding arrays</a><ul><li><a href="#nested-arrays" class="table-of-contents__link toc-highlight">Nested Arrays</a></li></ul></li><li><a href="#adding-explicit-mappings" class="table-of-contents__link toc-highlight">Adding explicit mappings</a></li><li><a href="#retrieving-mappings" class="table-of-contents__link toc-highlight">Retrieving Mappings</a></li><li><a href="#using-dot-notation-in-field-names" class="table-of-contents__link toc-highlight">Using dot notation in field names</a></li><li><a href="#adding-mappings-to-existing-indices" class="table-of-contents__link toc-highlight">Adding mappings to existing indices</a></li><li><a href="#how-dates-work-in-elasticsearch" class="table-of-contents__link toc-highlight">How dates work in Elasticsearch</a><ul><li><a href="#default-behavior-of-date-fields" class="table-of-contents__link toc-highlight">Default behavior of date fields</a></li><li><a href="#how-date-fields-are-stored" class="table-of-contents__link toc-highlight">How <code>date</code> fields are stored</a></li></ul></li><li><a href="#how-missing-fields-are-handled" class="table-of-contents__link toc-highlight">How missing fields are handled</a></li><li><a href="#overview-of-mapping-parameters" class="table-of-contents__link toc-highlight">Overview of mapping parameters</a><ul><li><a href="#format-parameter" class="table-of-contents__link toc-highlight"><code>format</code> parameter</a></li><li><a href="#properties-parameter" class="table-of-contents__link toc-highlight"><code>properties</code> parameter</a></li><li><a href="#coerce-parameter" class="table-of-contents__link toc-highlight"><code>coerce</code> parameter</a></li><li><a href="#introduction-to-doc_values" class="table-of-contents__link toc-highlight">Introduction to <code>doc_values</code></a></li><li><a href="#disabling-doc_values" class="table-of-contents__link toc-highlight">Disabling <code>doc_values</code></a></li><li><a href="#norms-parameter" class="table-of-contents__link toc-highlight"><code>norms</code> parameter</a></li><li><a href="#index-parameter" class="table-of-contents__link toc-highlight"><code>index</code> parameter</a></li><li><a href="#null_value-parameter" class="table-of-contents__link toc-highlight"><code>null_value</code> parameter</a></li><li><a href="#copy_to-parameter" class="table-of-contents__link toc-highlight"><code>copy_to</code> parameter</a></li></ul></li><li><a href="#updating-existing-mappings" class="table-of-contents__link toc-highlight">Updating existing mappings</a><ul><li><a href="#limitations-for-updating-mappings" class="table-of-contents__link toc-highlight">Limitations for updating mappings</a></li></ul></li><li><a href="#reindexing-documents-with-the-reindex-api" class="table-of-contents__link toc-highlight">Reindexing documents with the Reindex API</a><ul><li><a href="#__source-data-types" class="table-of-contents__link toc-highlight"><code>__source</code> data types</a></li><li><a href="#reindex-documents-matching-a-query" class="table-of-contents__link toc-highlight">Reindex documents matching a query</a></li><li><a href="#reindex-only-positive-reviews" class="table-of-contents__link toc-highlight">Reindex only positive reviews</a></li><li><a href="#removing-fields" class="table-of-contents__link toc-highlight">Removing fields</a></li><li><a href="#changing-a-fields-name" class="table-of-contents__link toc-highlight">Changing a field&#39;s name</a></li><li><a href="#using-ctxop-within-scripts" class="table-of-contents__link toc-highlight">Using <code>ctx.op</code> within scripts</a></li><li><a href="#parameters-for-the-reindex-api" class="table-of-contents__link toc-highlight">Parameters for the Reindex API</a></li><li><a href="#batching--throttling" class="table-of-contents__link toc-highlight">Batching &amp; Throttling</a></li></ul></li><li><a href="#defining-field-aliases" class="table-of-contents__link toc-highlight">Defining field aliases</a><ul><li><a href="#updating-field-aliases" class="table-of-contents__link toc-highlight">Updating field aliases</a></li><li><a href="#index-aliases" class="table-of-contents__link toc-highlight">Index Aliases</a></li></ul></li><li><a href="#multi-field-mappings" class="table-of-contents__link toc-highlight">Multi-field mappings</a></li><li><a href="#index-templates" class="table-of-contents__link toc-highlight">Index Templates</a><ul><li><a href="#structure-of-index-templates" class="table-of-contents__link toc-highlight">Structure of index Templates</a></li><li><a href="#priorities" class="table-of-contents__link toc-highlight">Priorities</a></li></ul></li><li><a href="#introduction-to-dynamic-mapping" class="table-of-contents__link toc-highlight">Introduction to dynamic mapping</a></li><li><a href="#configuring-dynamic-mapping" class="table-of-contents__link toc-highlight">Configuring dynamic mapping</a><ul><li><a href="#setting-dynamic-to-false" class="table-of-contents__link toc-highlight">Setting <code>dynamic</code> to <code>false</code></a></li><li><a href="#setting-dynamic-to-strict" class="table-of-contents__link toc-highlight">Setting <code>dynamic</code> to <code>strict</code></a></li><li><a href="#numeric-detection" class="table-of-contents__link toc-highlight">Numeric Detection</a></li></ul></li><li><a href="#dynamic-templates" class="table-of-contents__link toc-highlight">Dynamic Templates</a><ul><li><a href="#match-and-unmatch-parameters" class="table-of-contents__link toc-highlight"><code>match</code> and <code>unmatch</code> parameters</a></li><li><a href="#path_match-and-path_unmatch-parameters" class="table-of-contents__link toc-highlight"><code>path_match</code> and <code>path_unmatch</code> parameters</a></li><li><a href="#index-templates-vs-dynamic-templates" class="table-of-contents__link toc-highlight">Index templates vs dynamic templates</a></li></ul></li><li><a href="#mapping-recommendations" class="table-of-contents__link toc-highlight">Mapping Recommendations</a><ul><li><a href="#mapping-of-text-fields" class="table-of-contents__link toc-highlight">Mapping of text fields</a></li><li><a href="#disable-coercion" class="table-of-contents__link toc-highlight">Disable Coercion</a></li><li><a href="#use-appropriate-numeric-data-types" class="table-of-contents__link toc-highlight">Use appropriate numeric data types</a></li><li><a href="#mapping-parameters" class="table-of-contents__link toc-highlight">Mapping parameters</a></li><li><a href="#stemming--stop-words" class="table-of-contents__link toc-highlight">Stemming &amp; Stop words</a></li></ul></li><li><a href="#built-in-analyzers" class="table-of-contents__link toc-highlight">Built-in Analyzers</a><ul><li><a href="#standard-analyzer" class="table-of-contents__link toc-highlight"><code>standard</code> analyzer</a></li><li><a href="#simple-analyzer" class="table-of-contents__link toc-highlight"><code>simple</code> analyzer</a></li><li><a href="#whitespace-analyzer" class="table-of-contents__link toc-highlight"><code>whitespace</code> analyzer</a></li><li><a href="#keyword-analyzer" class="table-of-contents__link toc-highlight"><code>keyword</code> analyzer</a></li><li><a href="#pattern-analyzer" class="table-of-contents__link toc-highlight"><code>pattern</code> analyzer</a></li></ul></li><li><a href="#custom-analyzers" class="table-of-contents__link toc-highlight">Custom Analyzers</a></li><li><a href="#adding-analyzers-to-existing-indices" class="table-of-contents__link toc-highlight">Adding Analyzers to existing indices</a><ul><li><a href="#open--closed-indices" class="table-of-contents__link toc-highlight">Open &amp; Closed Indices</a></li><li><a href="#dynamic-and-static-settings" class="table-of-contents__link toc-highlight">Dynamic and static settings</a></li><li><a href="#opening--closing-indices" class="table-of-contents__link toc-highlight">Opening &amp; closing indices</a></li><li><a href="#updating-analyzers" class="table-of-contents__link toc-highlight">Updating Analyzers</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/elasticstack-notes/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/elasticstack-notes/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/devkobetran/elasticstack-notes" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Kobe Tran Elastic Stack Notes. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>