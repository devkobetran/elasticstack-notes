"use strict";(self.webpackChunkelasticstack_notes=self.webpackChunkelasticstack_notes||[]).push([[8167],{2259:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>o});var t=s(4848),r=s(8453);const i={sidebar_position:5},l="Controlling Query Results",a={id:"tutorial/controlling-query-results",title:"Controlling Query Results",description:"Specifying the result format",source:"@site/docs/tutorial/controlling-query-results.md",sourceDirName:"tutorial",slug:"/tutorial/controlling-query-results",permalink:"/elasticstack-notes/docs/tutorial/controlling-query-results",draft:!1,unlisted:!1,editUrl:"https://github.com/devkobetran/elasticstack-notes/docs/tutorial/controlling-query-results.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Joining Queries",permalink:"/elasticstack-notes/docs/tutorial/joining-queries"},next:{title:"Aggregations",permalink:"/elasticstack-notes/docs/tutorial/aggregations"}},c={},o=[{value:"Specifying the result format",id:"specifying-the-result-format",level:2},{value:"Source Filtering",id:"source-filtering",level:2},{value:"Specifying the result size",id:"specifying-the-result-size",level:2},{value:"Specifying an offset",id:"specifying-an-offset",level:2},{value:"Pagination",id:"pagination",level:2},{value:"Sorting Results",id:"sorting-results",level:2},{value:"Sorting by multi-value fields",id:"sorting-by-multi-value-fields",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"controlling-query-results",children:"Controlling Query Results"})}),"\n",(0,t.jsx)(n.h2,{id:"specifying-the-result-format",children:"Specifying the result format"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search?format=yaml\n{\n    "query": {\n        "match": { "title": "pasta" }\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Make the response pretty"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search?pretty\n{\n    "query": {\n        "match": { "title": "pasta" }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"source-filtering",children:"Source Filtering"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search\n{\n    "_source": "created",\n    "query": {\n        "match": { "title": "pasta" }\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Example returns match all properties within the objects stored within the ingredients array"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search\n{\n    "_source": "ingredients.*",\n    "query": {\n        "match": { "title": "pasta" }\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Example that name property is no longer returned for each object within the ingredients field"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search\n{\n    "_source": {\n        "includes": "ingredients.*",\n        "excludes": "ingredients.name"\n    }\n    "query": {\n        "match": { "title": "pasta" }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"specifying-the-result-size",children:"Specifying the result size"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Two Examples below output same thing where 2 matches are shown"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search?size=2\n{\n    "_source": false,\n    "query": {\n        "match": {\n            "title": "pasta"\n        }\n    }\n}\n\nGET /recipes/_search\n{\n    "size": 2,\n    "_source": false,\n    "query": {\n        "match": {\n            "title": "pasta"\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"specifying-an-offset",children:"Specifying an offset"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search\n{\n    "size": 2,\n    "_source": false,\n    "from": 4,\n    "query": {\n        "match": {\n            "title": "pasta"\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"from"})," paramter is like the offset clause in SQL"]})}),"\n",(0,t.jsx)(n.h2,{id:"pagination",children:"Pagination"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-body.html#request-body-search-search-after",children:"Pagination Docs"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"total_pages = ceil(total_hits / page_size)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"from = (page_size * (page_number - 1))"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"sorting-results",children:"Sorting Results"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search\n{\n    "_source": false,\n    "query": {\n        "match_all": {}\n    },\n    "sort": [\n        "preparation_time_minutes"\n    ]\n}\n\nGET /recipes/_search\n{\n    "_source": "created",\n    "query": {\n        "match_all": {}\n    },\n    "sort": [\n        { "created": "desc" }\n    ]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"sorting-by-multi-value-fields",children:"Sorting by multi-value fields"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'GET /recipes/_search\n{\n    "_source": "ratings",\n    "query": {\n        "match_all": {}\n    },\n    "sort": [\n        {\n            "ratings": {\n                "order": "desc",\n                "mode": "avg"\n            }\n        }\n    ]\n}\n'})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var t=s(6540);const r={},i=t.createContext(r);function l(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);